{% extends "college_admin/base/base_dashboard.html" %}
{% block title %}Events Registry{% endblock %}

{% block content %}

<header class="top-bar">
    <div class="welcome-text">
        <h1>Events Registry</h1>
        <p class="text-muted">Events registered in {{ current_year }}</p>
    </div>
</header>

<div class="card">
    <div class="events-list">

        {% for event in events %}
        <div class="event-item event-clickable"
             onclick="toggleSubEvents('sub-{{ event.id }}')">

            <div class="event-date">
                <span>{{ event.start_date|date:"d" }}</span>
                <small>{{ event.start_date|date:"M" }}</small>
            </div>

            <div class="event-details">
                <h5>{{ event.title }}</h5>
                <p>
                    <i class="fas fa-layer-group"></i>
                    {{ event.department.name }}
                </p>
            </div>

            <span class="status-badge status-upcoming">
                {{ event.subevent_set.count }} Sub Events
            </span>
        </div>

        <!-- SUB EVENTS -->
        <div id="sub-{{ event.id }}" class="subevents-container" style="display:none;">

            {% for sub in event.subevent_set.all %}
            <div class="event-item" style="margin-left:40px;">
                <div class="event-details">
                    <h5>{{ sub.title }}</h5>
                    <p class="text-muted">{{ sub.start_time|date:"M d, Y H:i" }}</p>
                    <p class="text-muted">{{ sub.venue }}</p>
                </div>

                {% if sub.is_team_event %}
                    <span class="status-badge status-pending">Team</span>
                {% else %}
                    <span class="status-badge status-upcoming">Solo</span>
                {% endif %}
            </div>
            {% empty %}
            <p class="text-muted" style="margin-left:40px;">
                No sub events
            </p>
            {% endfor %}
        </div>

        {% empty %}
        <p class="text-muted">No events registered this year.</p>
        {% endfor %}

    </div>
</div>

{% endblock %}
